use movie;
-- Retrieve the total number of movies in the dataset.
select count(title)
from imdb_movie;
-- Calculate the total revenue generated from all movies.
select sum(revenue_millions)
from imdb_movie;
-- Identify the highest-grossing movie.
select Title,Revenue_Millions
from imdb_movie
order by Revenue_Millions desc limit 1;

-- Identify the most common genre in the dataset.
Select Genre,count(Genre) AS Genre_count
from imdb_movie
Group By Genre
Order By Genre_count desc limit 1;
-- List the top 5 highest-rated movies along with their ratings
select Title,Rating
from imdb_movie
order by Rating desc limit 5;
-- Determine the distribution of movie releases by year
select count(Title),Year
from imdb_movie
group by Year
Order by year;
-- find the average rating of movies in each genre.
select Genre,Avg(Rating) AS Avg_rating
from imdb_movie
Group By Genre;
-- Group the movies by director and
-- calculate the average revenue 
-- generated by each director's movies
select Director,Avg(Revenue_Millions)as Avg_revenue
from imdb_movie
group by Director;
-- Determine the top 3 actors who have appeared in the most movies.
select Actors, count(Actors) as top_actors
from imdb_movie
group by Actors
order by top_actors desc limit 3;
-- Calculate the percentage contribution of each genre 
-- to total box office revenue
select Genre,Sum(Revenue_Millions)/(select sum(Revenue_millions)
from imdb_movie)*100 as Percentage_contribution
from imdb_movie
Group By Genre;
-- Determine the top 3 highest-grossing movies for each genre.
select Title, Genre, sum_revenue from
(select Genre, Title, sum_revenue,rank()over(partition by Genre order by sum_revenue desc)as b
from
(select Title,Genre,sum(Revenue_millions) as sum_revenue
from imdb_movie
group by Genre,Title) as a)as c
where b<=3;
